<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-11-23">

<title>ChatGPT Daily Brief (CDB) – riki’s site</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">riki’s site</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../02_articles.html"> 
<span class="menu-text">articles &amp; papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../01_projects.html"> 
<span class="menu-text">projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog/index_blog.html"> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cdb/index_cdb.html"> 
<span class="menu-text">ChatGPT’s daily brief</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#lead-assessment" id="toc-lead-assessment" class="nav-link active" data-scroll-target="#lead-assessment">Lead Assessment</a></li>
  <li><a href="#regional-spotlights" id="toc-regional-spotlights" class="nav-link" data-scroll-target="#regional-spotlights">Regional Spotlights</a>
  <ul class="collapse">
  <li><a href="#levant-israellebanon" id="toc-levant-israellebanon" class="nav-link" data-scroll-target="#levant-israellebanon">Levant / Israel–Lebanon</a></li>
  <li><a href="#black-sea-ukraine" id="toc-black-sea-ukraine" class="nav-link" data-scroll-target="#black-sea-ukraine">Black Sea / Ukraine</a></li>
  <li><a href="#south-china-sea-philippines" id="toc-south-china-sea-philippines" class="nav-link" data-scroll-target="#south-china-sea-philippines">South China Sea / Philippines</a></li>
  <li><a href="#latin-america-venezuela" id="toc-latin-america-venezuela" class="nav-link" data-scroll-target="#latin-america-venezuela">Latin America / Venezuela</a></li>
  <li><a href="#africa-sahelhornsudan" id="toc-africa-sahelhornsudan" class="nav-link" data-scroll-target="#africa-sahelhornsudan">Africa / Sahel–Horn–Sudan</a></li>
  </ul></li>
  <li><a href="#watch-items-next-24-72-h" id="toc-watch-items-next-24-72-h" class="nav-link" data-scroll-target="#watch-items-next-24-72-h">Watch Items (Next 24-72 h)</a></li>
  <li><a href="#annex-business-financial-indicators" id="toc-annex-business-financial-indicators" class="nav-link" data-scroll-target="#annex-business-financial-indicators">Annex — Business &amp; Financial Indicators</a>
  <ul class="collapse">
  <li><a href="#macro-markets" id="toc-macro-markets" class="nav-link" data-scroll-target="#macro-markets">Macro &amp; Markets</a></li>
  <li><a href="#energy-resources" id="toc-energy-resources" class="nav-link" data-scroll-target="#energy-resources">Energy &amp; Resources</a></li>
  <li><a href="#defense-industrial-base" id="toc-defense-industrial-base" class="nav-link" data-scroll-target="#defense-industrial-base">Defense / Industrial Base</a></li>
  <li><a href="#notes-on-confidence" id="toc-notes-on-confidence" class="nav-link" data-scroll-target="#notes-on-confidence">Notes on Confidence</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ChatGPT Daily Brief (CDB)</h1>
<p class="subtitle lead">Open-Source Intelligence Edition</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="lead-assessment" class="level2">
<h2 class="anchored" data-anchor-id="lead-assessment">Lead Assessment</h2>
<p><strong>Hezbollah Chief-of-Staff Eliminated in Beirut Strike — Major Risk of Border Escalation.</strong></p>
<ul>
<li>Israeli aerial strike in the Haret Hreik district of Beirut reportedly killed one of Hezbollah’s most senior commanders, Haytham Ali Tabatabai, along with multiple operatives. (<a href="https://www.theguardian.com/world/2025/nov/23/israel-targets-hezbollah-chief-of-staff-in-strike-on-beirut?utm_source=chatgpt.com" title="Hezbollah chief of staff killed in Beirut airstrike, Israeli military says">The Guardian</a>)</li>
<li>Lebanon’s government condemned the strike and signalled submission of a formal complaint to the United Nations; Hezbollah vowed retaliation.</li>
<li><strong>We assess</strong> this event significantly raises the likelihood of broader Lebanese front escalation—cross-border shelling, attacks on Israeli shipping or energy infrastructure are now credible within a 72-hour window. <strong>(Moderate-High confidence)</strong></li>
<li><strong>Business/Financial Implications:</strong> Elevated insurance premiums for eastern Mediterranean shipping lanes; regional energy servicing and logistics risks may spike; firms with exposure in Lebanese or Israeli equities should flag elevated geo-risk.</li>
</ul>
<hr>
</section>
<section id="regional-spotlights" class="level2">
<h2 class="anchored" data-anchor-id="regional-spotlights">Regional Spotlights</h2>
<section id="levant-israellebanon" class="level3">
<h3 class="anchored" data-anchor-id="levant-israellebanon">Levant / Israel–Lebanon</h3>
<ul>
<li><strong>Situation:</strong> The targeted strike inside Beirut marks a deviation from prior Israeli operations primarily in southern Lebanon. Hezbollah has declared “the rules have changed.”</li>
<li><strong>Assessment:</strong> Israel appears to upgrade from “border containment” to “command decapitation” strategy — we judge Hezbollah may escalate asymmetric attacks along the Blue Line or in maritime zones rather than full-scale war. <strong>(Moderate confidence)</strong></li>
<li><strong>Indicators to watch:</strong> Hezbollah rocket/mortar launches into northern Israel; return Israeli airstrikes in Lebanon; calls by UNIFIL for large-scale intervention; Israeli shipping corridor alerts.</li>
</ul>
<hr>
</section>
<section id="black-sea-ukraine" class="level3">
<h3 class="anchored" data-anchor-id="black-sea-ukraine">Black Sea / Ukraine</h3>
<ul>
<li><strong>Situation:</strong> According to Institute for the Study of War (ISW), Russian President Vladimir Putin reiterated rejection of the U.S.-draft 28-point peace plan and ordered continued broad-front operations. (<a href="https://www.criticalthreats.org/analysis/russian-offensive-campaign-assessment-november-21-2025?utm_source=chatgpt.com" title="Russian Offensive Campaign Assessment, November 21, 2025">Critical Threats</a>)</li>
<li><strong>Assessment:</strong> We assess Russia is maintaining a strategy of attrition, targeting Ukrainian logistics and energy infrastructure ahead of winter. Territorial gains are unlikely a priority; degrading enemy will-to-fight is. <strong>(High confidence)</strong></li>
<li><strong>Business/Financial Implications:</strong> Ukraine export corridors remain at risk—grain and fertiliser flows may be disrupted; European defence stock-profiles remain robust; shipping/insurance for Black Sea routes maintain elevated risk premiums.</li>
<li><strong>Indicators to watch:</strong> Reports of Ukrainian grid failures; new port raids in Odesa vicinity; CMEA-style export route closures.</li>
</ul>
<hr>
</section>
<section id="south-china-sea-philippines" class="level3">
<h3 class="anchored" data-anchor-id="south-china-sea-philippines">South China Sea / Philippines</h3>
<ul>
<li><strong>Situation:</strong> No confirmed new kinetic incident publicly surfaced today.</li>
<li><strong>Assessment:</strong> The operational risk remains moderate-low, but the structural maritime friction between the Philippines, China and trans-regional shipping persists unabated. <strong>(Low–Moderate confidence)</strong></li>
<li><strong>Business/Financial Implications:</strong> Insurance premia for Luzon-adjacent sea lanes likely remain elevated; logistics firms should monitor PCG/PN coast-guard escort cycles and Chinese maritime militia activity.</li>
<li><strong>Indicators to watch:</strong> Vessel harassment in Scarborough Shoal, coast-guard audio/visual footage, Manila’s dispatch of naval assets.</li>
</ul>
<hr>
</section>
<section id="latin-america-venezuela" class="level3">
<h3 class="anchored" data-anchor-id="latin-america-venezuela">Latin America / Venezuela</h3>
<ul>
<li><strong>Situation:</strong> No major new headline incident today.</li>
<li><strong>Assessment:</strong> While near-term volatility is limited, the latent risk of U.S. policy shifts and infrastructure disruption in Venezuela remains higher than regional peers. <strong>(Moderate confidence)</strong></li>
<li><strong>Business/Financial Implications:</strong> Energy firms with PDVSA exposure face ongoing sanction risk; regional logistics and port trade flows continue to present selective opportunity but carry headline risk premium.</li>
<li><strong>Indicators to watch:</strong> U.S. Treasury sanction notices, Caracas-Bogota security cooperation updates, shipping disclosures on heavy-sour crude flows.</li>
</ul>
<hr>
</section>
<section id="africa-sahelhornsudan" class="level3">
<h3 class="anchored" data-anchor-id="africa-sahelhornsudan">Africa / Sahel–Horn–Sudan</h3>
<ul>
<li><strong>Situation:</strong> No fresh major developments in the Sahel/Sudan theatres reported publicly today.</li>
<li><strong>Assessment:</strong> Structural risks remain elevated—an escalation turn is still possible, but immediate probability remains moderate. <strong>(Low confidence)</strong></li>
<li><strong>Business/Financial Implications:</strong> NGOs, logistics firms and commodity supply-chain operators should remain alert for sudden access collapses.</li>
<li><strong>Indicators to watch:</strong> RSF/SAF troop movements, major IDP flows, border closure announcements, major UN/OCHA advisories.</li>
</ul>
<hr>
</section>
</section>
<section id="watch-items-next-24-72-h" class="level2">
<h2 class="anchored" data-anchor-id="watch-items-next-24-72-h">Watch Items (Next 24-72 h)</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 23%">
<col style="width: 37%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Priority</th>
<th>Issue</th>
<th>Why It Matters</th>
<th>Key Indicators</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Israel-Lebanon escalation</td>
<td>Strike on Hezbollah senior leadership may trigger asymmetric attacks</td>
<td>Hezbollah missile launches, Blue Line flare-ups, shipping alerts</td>
</tr>
<tr class="even">
<td>2</td>
<td>Ukraine export corridor disruption</td>
<td>Winter targeting campaign intensifies risk of logistics/energy hits</td>
<td>Port/rail strike reports, Ukrainian grid outages, export volume drops</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Yen instability &amp; FX shock</td>
<td>Sudden FX move may spill into global risk assets</td>
<td>JPY moves, BOJ/MOF commentary, carry-trade unwind</td>
</tr>
<tr class="even">
<td>4</td>
<td>U.S. sanctions/hydrocarbon flows in Venezuela</td>
<td>Elevation of sanction risk may affect global oil/delivery chains</td>
<td>U.S. Treasury announcements, vessel tracking of heavy-sour flows</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Middle East-MENA sovereign debt stress</td>
<td>Elevated U.S. rates and fiscal strain in MENA may prompt sudden repricing</td>
<td>Credit-default swaps, rating agency commentary, bond yields</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="annex-business-financial-indicators" class="level2">
<h2 class="anchored" data-anchor-id="annex-business-financial-indicators">Annex — Business &amp; Financial Indicators</h2>
<section id="macro-markets" class="level3">
<h3 class="anchored" data-anchor-id="macro-markets">Macro &amp; Markets</h3>
<ul>
<li>Risk-assets are on edge; elevated valuation levels, FX carry risk, and geo-political triggers co-exist.</li>
<li><strong>Assessment:</strong> Without a clear positive catalyst, downside is skewed. <strong>(Moderate confidence)</strong></li>
</ul>
</section>
<section id="energy-resources" class="level3">
<h3 class="anchored" data-anchor-id="energy-resources">Energy &amp; Resources</h3>
<ul>
<li>Strike in Lebanon increases service-hub disruption risk; Ukraine export corridor remains a major supply-chain node.</li>
<li><strong>Assessment:</strong> Premiums for shipping/logistics may further widen; firms with alternative routes or diversified portfolios are advantaged. <strong>(Moderate confidence)</strong></li>
</ul>
</section>
<section id="defense-industrial-base" class="level3">
<h3 class="anchored" data-anchor-id="defense-industrial-base">Defense / Industrial Base</h3>
<ul>
<li>Russia’s refusal of the 28-point peace plan signals prolonged high-intensity defence demand.</li>
<li><strong>Assessment:</strong> Defence contractors with AD, munitions, logistics sustain order-book visibility; softer macro may constrain margins. <strong>(Moderate confidence)</strong></li>
</ul>
<hr>
</section>
<section id="notes-on-confidence" class="level3">
<h3 class="anchored" data-anchor-id="notes-on-confidence">Notes on Confidence</h3>
<ul>
<li><strong>High:</strong> Strong corroboration by multiple credible sources, direct evidence.</li>
<li><strong>Moderate:</strong> Good reporting but still evolving or partial visibility.</li>
<li><strong>Low:</strong> Fragmentary data, single source or subject to rapid change.</li>
</ul>
<hr>


</section>
</section>

</main> <!-- /main -->
<hr style="margin-top:2em;margin-bottom:1em;">

<p><strong>Disclaimer:</strong> The ChatGPT Daily Brief (CDB), or any Special Brief (SB) is automatically generated from open-source material and may contain errors, omissions, or outdated information. It is provided “as is,” without warranties of any kind, express or implied. The CDB/SB is not investment, legal, security, or policy advice and must not be relied upon for decision-making. You are responsible for independently verifying facts and conclusions with primary sources and qualified professionals. Neither the author nor providers of this service accept any liability for losses or harms arising from use of this content. No duty to update is assumed.</p>


<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>